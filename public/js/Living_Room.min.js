b4w.register("Living_Room",function(O,e){function P(a,c){c?(C.create_preloader(),a.addEventListener("mousedown",D),a.addEventListener("touchstart",D),a.addEventListener("mouseup",E),a.addEventListener("touchend",E),a.addEventListener("mousemove",F),a.addEventListener("touchmove",F),window.onresize=y.resize_to_container,y.resize_to_container(),k.load(m+"environment.json",Q,R)):console.log("b4w init failure")}function R(a){C.update_preloader(a)}function Q(){t.enable_camera_controls(!1,!1,!1,y.get_canvas());
S();var a=l.get_object_by_name("spawner");g.get_translation(a,z)}function S(){var a=document.getElementById("spinner-container"),c=document.getElementById("item-container");document.getElementById("controls-container").style.display="block";c.style.display="block";T();document.getElementById("load-1").addEventListener("click",function(){a.style.display="block";k.load(m+"couch.json",q,null,null,!0)});document.getElementById("load-2").addEventListener("click",function(){a.style.display="block";k.load(m+
"love_seat.json",q,null,null,!0)});document.getElementById("load-3").addEventListener("click",function(){a.style.display="block";k.load(m+"chair.json",q,null,null,!0)});document.getElementById("load-4").addEventListener("click",function(){a.style.display="block";k.load(m+"table.json",q,null,null,!0)});document.getElementById("load-5").addEventListener("click",function(){a.style.display="block";k.load(m+"tv_stand.json",q,null,null,!0)});document.getElementById("load-6").addEventListener("click",function(){a.style.display=
"block";k.load(m+"end_table.json",q,null,null,!0)});document.getElementById("load-7").addEventListener("click",function(){for(var a=h.get_selectable_objects(),d="$",c=!1,f=0;f<a.length;f++){var e=a[f];1==n.get_sensor_value(e,"COLLISION",0)&&(c=!0);e=g.get_object_bounding_box(e);d=d+e.min_x.toFixed(3)+","+e.max_x.toFixed(3)+","+e.min_y.toFixed(3)+","+e.max_y.toFixed(3)+","+e.min_z.toFixed(3)+","+e.max_z.toFixed(3)+"$"}0==c?prompt("Here is your result! Please copy (CTRL+C) and paste into survey.",d):
window.alert("Please ensure there are no overlapping objects and try again.")});document.getElementById("delete").addEventListener("click",function(){if(f){var a=l.get_object_data_id(f);k.unload(a);f=null}});document.getElementById("rot-ccw").addEventListener("click",function(){f&&G(f,H)});document.getElementById("rot-cw").addEventListener("click",function(){f&&G(f,-H)})}function T(){for(var a=["delete","rot-ccw","rot-cw"],c=0;c<a.length;c++){var b=a[c];document.getElementById(b).addEventListener("mousedown",
function(a){a.target.parentNode.classList.add("active")});document.getElementById(b).addEventListener("mouseup",function(a){a.target.parentNode.classList.remove("active")});document.getElementById(b).addEventListener("touchstart",function(a){a.target.parentNode.classList.add("active")});document.getElementById(b).addEventListener("touchend",function(a){a.target.parentNode.classList.remove("active")})}}function q(a){var c=document.getElementById("spinner-container");a=l.get_all_objects("ALL",a);for(var b=
0;b<a.length;b++){var d=a[b];if(I.has_physics(d)){I.enable_simulation(d);var e=n.create_collision_sensor(d,"FURNITURE"),k=n.create_selection_sensor(d,!0);d==f&&n.set_custom_sensor(k,1);n.create_sensor_manifold(d,"COLLISION",n.CT_CONTINUOUS,[e,k],U,V);(e=h.get_parent(d))&&h.is_armature(e)?g.set_translation_v(e,z):g.set_translation_v(d,z)}h.is_mesh(d)&&(l.show_object(d),c.style.display="none")}}function U(a){return a[1]}function V(a,c,b){1==b&&(n.get_sensor_value(a,c,0)?l.set_outline_color(W):l.set_outline_color(X))}
function G(a,c){var b=h.get_parent(a);if(b&&h.is_armature(b)){var d=g.get_rotation(b,J);K.rotateZ(d,c,d);g.set_rotation_v(b,d)}else d=g.get_rotation(a,J),K.rotateZ(d,c,d),g.set_rotation_v(a,d);L(a)}function D(a){A=!0;a.preventDefault&&a.preventDefault();var c=v.get_coords_x(a);a=v.get_coords_y(a);var b=l.pick_object(c,a);f!=b&&(f&&l.clear_outline_anim(f),b&&l.apply_outline_anim(b,1,1,0),f=b);if(f){var b=l.get_active_camera(),d=h.get_parent(f);d&&h.is_armature(d)?g.get_translation(d,r):g.get_translation(f,
r);M.project_point(b,r,p);p[0]=c-p[0];p[1]=a-p[1]}}function E(){A=!1;w||(t.enable_camera_controls(),w=!0)}function F(a){if(A&&f){w&&(t.disable_camera_controls(),w=!1);var c=l.get_active_camera(),b=v.get_coords_x(a);a=v.get_coords_y(a);0<=b&&0<=a&&(b-=p[0],a-=p[1],b=M.calc_ray(c,b,a,x),b=u.get_pline_directional_vec(b,r),c=g.get_translation(c,Y),u.set_pline_initial_point(x,c),u.set_pline_directional_vec(x,b),(c=u.line_plane_intersect(Z,0,x,aa))&&0>b[2]&&((b=h.get_parent(f))&&h.is_armature(b)?g.set_translation_v(b,
c):g.set_translation_v(f,c),L(f)))}}function L(a){var c=g.get_object_bounding_box(a),b=h.get_parent(a),d=b&&h.is_armature(b)?g.get_translation(b,r):g.get_translation(a,r);4.572<c.max_x?d[0]-=c.max_x-4.572:0>c.min_x&&(d[0]+=0-c.min_x);5.182<c.max_y?d[1]-=c.max_y-5.182:0>c.min_y&&(d[1]+=0-c.min_y);b&&h.is_armature(b)?g.set_translation_v(b,d):g.set_translation_v(a,d)}var t=e("app"),M=e("camera"),ba=e("config"),y=e("container"),n=e("controls"),k=e("data"),v=e("mouse"),u=e("math"),h=e("objects"),I=e("physics"),
C=e("preloader"),l=e("scenes"),g=e("transform"),N=e("version"),N=e("version"),K=e("quat"),B="DEBUG"===N.type(),X=[0,1,0],W=[1,0,0],Z=[0,0,1],H=Math.PI/2,m=ba.get_std_assets_path("Living_Room"),p=new Float32Array(2),z=new Float32Array(3),r=new Float32Array(3),Y=new Float32Array(3),aa=new Float32Array(3),J=new Float32Array(4),x=u.create_pline(),A=!1,w=!0,f=null;O.init=function(){var a=B,c=t.get_url_params();c&&"show_fps"in c&&(a=!0);t.init({canvas_container_id:"main_canvas_container",callback:P,physics_enabled:!0,
show_fps:a,alpha:!1,assets_dds_available:!B,assets_min50_available:!B,background_color:[1,1,1,0]})}});b4w.require("Living_Room").init();
